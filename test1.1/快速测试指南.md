# AES-SM3å®Œæ•´æ€§æ ¡éªŒç®—æ³• - å¿«é€Ÿæµ‹è¯•æŒ‡å—

## ğŸš€ Ubuntuä¸Šä¸€é”®æµ‹è¯•ï¼ˆæœ€ç®€å•ï¼‰

```bash
# æ·»åŠ æ‰§è¡Œæƒé™
chmod +x compile_and_test.sh

# è¿è¡Œæµ‹è¯•ï¼ˆè‡ªåŠ¨å¤„ç†ç¼–è¯‘é—®é¢˜ï¼‰
./compile_and_test.sh
```

## ğŸ“ æµ‹è¯•ä¿®æ”¹è¯´æ˜

### å·²å®Œæˆçš„ä¿®æ”¹ï¼š

1. âœ“ **é¢œè‰²è¾“å‡ºå·²ç¦ç”¨** - ä½¿ç”¨é»˜è®¤å­—ä½“é¢œè‰²
2. âœ“ **SHA256ç¡¬ä»¶åŠ é€Ÿç›®æ ‡å·²ä¿®æ”¹ä¸ºâ‰¥10å€**
3. âœ“ **æ‰€æœ‰ç›¸å…³æ–‡æ¡£å·²åŒæ­¥æ›´æ–°**

### æ€§èƒ½ç›®æ ‡ï¼ˆä¿®æ”¹åï¼‰ï¼š

| å¯¹æ¯”é¡¹ç›® | ç›®æ ‡å€¼ |
|---------|-------|
| vs SHA256ç¡¬ä»¶åŠ é€Ÿ | **â‰¥10å€** â¬… å·²ä¿®æ”¹ |
| vs çº¯SM3 | 50-60å€ |
| å•å—å¤„ç†ååé‡ | 35,000-55,000 MB/s |

## ğŸ”§ è§£å†³mainå‡½æ•°å†²çªçš„æ–¹æ³•

### æ–¹æ³•1ï¼šä½¿ç”¨è‡ªåŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
chmod +x compile_and_test.sh
./compile_and_test.sh
```

è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
- åˆ›å»ºä¸å«mainå‡½æ•°çš„åº“æ–‡ä»¶
- é€‰æ‹©æœ€ä¼˜ç¼–è¯‘é€‰é¡¹
- ç¼–è¯‘æµ‹è¯•ç¨‹åº
- è¿è¡Œæµ‹è¯•
- æ¸…ç†ä¸´æ—¶æ–‡ä»¶

### æ–¹æ³•2ï¼šæ‰‹åŠ¨ç¼–è¯‘

```bash
# 1. åˆ›å»ºåº“æ–‡ä»¶ï¼ˆå»é™¤mainå‡½æ•°ï¼‰
head -n 3413 aes_sm3_integrity.c > aes_sm3_integrity_lib.c

# 2. ç¼–è¯‘æµ‹è¯•
gcc -march=armv8.2-a+crypto -O3 -funroll-loops -ftree-vectorize \
    -finline-functions -ffast-math -flto -fomit-frame-pointer -pthread \
    -o test_aes_sm3 aes_sm3_integrity_lib.c test_aes_sm3_integrity.c -lm

# 3. è¿è¡Œæµ‹è¯•
./test_aes_sm3

# 4. æ¸…ç†ä¸´æ—¶æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
rm aes_sm3_integrity_lib.c
```

### æ–¹æ³•3ï¼šåªè¿è¡Œä¸»ç¨‹åºçš„å†…ç½®æµ‹è¯•

å¦‚æœåªæƒ³å¿«é€ŸéªŒè¯ç®—æ³•åŠŸèƒ½ï¼š

```bash
# ç¼–è¯‘ä¸»ç¨‹åº
gcc -march=armv8.2-a+crypto -O3 -funroll-loops -ftree-vectorize \
    -finline-functions -ffast-math -flto -fomit-frame-pointer -pthread \
    -o aes_sm3_integrity aes_sm3_integrity.c -lm

# è¿è¡Œï¼ˆåŒ…å«å†…ç½®æ€§èƒ½æµ‹è¯•ï¼‰
./aes_sm3_integrity
```

## ğŸ“Š é¢„æœŸæµ‹è¯•è¾“å‡ºï¼ˆä¿®æ”¹åï¼‰

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ€§èƒ½åŸºå‡†æµ‹è¯•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â–¶ æµ‹è¯•: vs SHA256/SM3åŸºå‡†æ€§èƒ½å¯¹æ¯”

  â–¶ SHA256ç¡¬ä»¶åŠ é€Ÿæ€§èƒ½:
    ååé‡: 2500.30 MB/s
  
  â–¶ çº¯SM3ç®—æ³•æ€§èƒ½:
    ååé‡: 800.15 MB/s
  
  â–¶ XOR-SM3æ··åˆç®—æ³•ï¼ˆv5.0 Superï¼‰:
    ååé‡: 25000.50 MB/s
  
  æ€§èƒ½åŠ é€Ÿæ¯”æ±‡æ€»:
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  vs SHA256ç¡¬ä»¶åŠ é€Ÿ: 10.00x âœ“ è¾¾æ ‡ï¼ˆç›®æ ‡â‰¥10xï¼‰    â¬… ä¿®æ”¹å
  vs çº¯SM3ç®—æ³•:     31.25x âœ“ è¾¾æ ‡ï¼ˆç›®æ ‡50-60xï¼‰
âœ“ é€šè¿‡ (è€—æ—¶: 5.630000ç§’)
```

## ğŸ’¡ ç¼–è¯‘å¤±è´¥è§£å†³æ–¹æ¡ˆ

### é”™è¯¯1ï¼šä¸æ”¯æŒ `-march=armv8.2-a+crypto`

```bash
# ä½¿ç”¨å¤‡é€‰ç¼–è¯‘é€‰é¡¹
gcc -march=armv8-a+crypto -O3 -pthread \
    -o test_aes_sm3 aes_sm3_integrity_lib.c test_aes_sm3_integrity.c -lm
```

### é”™è¯¯2ï¼šmultiple definition of 'main'

è¿™æ­£æ˜¯æˆ‘ä»¬è¦è§£å†³çš„é—®é¢˜ï¼Œä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•1æˆ–æ–¹æ³•2å³å¯ã€‚

### é”™è¯¯3ï¼šæ‰¾ä¸åˆ°gcc

```bash
# Ubuntu/Debian
sudo apt-get update
sudo apt-get install build-essential

# CentOS/RHEL
sudo yum groupinstall "Development Tools"
```

## ğŸ¯ å®Œæ•´æµ‹è¯•æµç¨‹

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd ~/sm3/test1.1

# 2. ç¡®è®¤æ–‡ä»¶å­˜åœ¨
ls aes_sm3_integrity.c test_aes_sm3_integrity.c

# 3. è¿è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬
chmod +x compile_and_test.sh
./compile_and_test.sh

# 4. æŸ¥çœ‹ç»“æœ
# æµ‹è¯•ä¼šè‡ªåŠ¨è¿è¡Œå¹¶æ˜¾ç¤ºç»“æœ
# æˆåŠŸæ—¶é€€å‡ºç ä¸º0ï¼Œå¤±è´¥æ—¶é0
echo $?
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

åœ¨åä¸ºäº‘KC2æˆ–å…¶ä»–ç”Ÿäº§ç¯å¢ƒæµ‹è¯•æ—¶ï¼š

```bash
# 1. è®¾ç½®CPUä¸ºæ€§èƒ½æ¨¡å¼
echo performance | sudo tee /sys/devices/system/cpu/cpu*/cpufreq/scaling_governor

# 2. è¿è¡Œæµ‹è¯•
./compile_and_test.sh

# 3. æ¢å¤CPUèŠ‚èƒ½æ¨¡å¼ï¼ˆæµ‹è¯•å®Œæˆåï¼‰
echo ondemand | sudo tee /sys/devices/system/cpu/cpu*/cpufreq/scaling_governor
```

## ğŸ“š æ›´å¤šä¿¡æ¯

- **è¯¦ç»†æµ‹è¯•æ–‡æ¡£**: `TEST_README.md`
- **æ–‡ä»¶è¯´æ˜**: `æµ‹è¯•æ–‡ä»¶è¯´æ˜.md`
- **å®Œæˆæ€»ç»“**: `æµ‹è¯•å¥—ä»¶å®Œæˆæ€»ç»“.txt`

## âœ… ä¿®æ”¹æ£€æŸ¥æ¸…å•

- [x] æµ‹è¯•ç¨‹åºé¢œè‰²è¾“å‡ºå·²ç¦ç”¨
- [x] SHA256ç¡¬ä»¶åŠ é€Ÿç›®æ ‡æ”¹ä¸ºâ‰¥10å€
- [x] test_aes_sm3_integrity.c å·²æ›´æ–°
- [x] TEST_README.md å·²æ›´æ–°
- [x] æµ‹è¯•æ–‡ä»¶è¯´æ˜.md å·²æ›´æ–°
- [x] æµ‹è¯•å¥—ä»¶å®Œæˆæ€»ç»“.txt å·²æ›´æ–°
- [x] åˆ›å»ºäº†compile_and_test.shè‡ªåŠ¨ç¼–è¯‘è„šæœ¬
- [x] åˆ›å»ºäº†æœ¬å¿«é€Ÿæµ‹è¯•æŒ‡å—

æ‰€æœ‰ä¿®æ”¹å·²å®Œæˆï¼ğŸ‰

